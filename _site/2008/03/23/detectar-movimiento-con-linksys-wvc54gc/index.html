<!DOCTYPE html>
<html>
  <head>
    

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    

    <title>Detectar movimiento con Linksys WVC54GC</title>
    <meta name="description"
          content="Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito.

">
    <meta name="author" content="Gonzalo Ayuso">
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Detectar movimiento con Linksys WVC54GC">
    <meta name="twitter:description"
          content="Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito.

">
    
    <meta name="twitter:creator" content="gonzalo123">
    
    <meta name="twitter:image" content="/images/favicons/favicon-194x194.png"/>

    <meta property="og:type" content="article">
    <meta property="og:title" content="Detectar movimiento con Linksys WVC54GC">
    <meta property="og:description"
          content="Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito.

">
    <meta property="og:image" content="/images/favicons/favicon-194x194.png"/>

    <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
    <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
    <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png"
          sizes="192x192">
    <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/images/favicons/manifest.json">
    <link rel="shortcut icon" href="/images/favicons/favicon.ico">
    <meta name="msapplication-TileColor" content="#ffc40d">
    <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="/css/main.css?1617453764168120000">
    <link rel="canonical"
          href="/2008/03/23/detectar-movimiento-con-linksys-wvc54gc/">
    <link rel="alternate" type="application/rss+xml" title="Gonzalo Ayuso" href="/feed.xml">
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>Detectar movimiento con Linksys WVC54GC | Gonzalo Ayuso</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="Detectar movimiento con Linksys WVC54GC" />
<meta name="author" content="Gonzalo Ayuso" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito." />
<meta property="og:description" content="Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito." />
<link rel="canonical" href="/2008/03/23/detectar-movimiento-con-linksys-wvc54gc/" />
<meta property="og:url" content="/2008/03/23/detectar-movimiento-con-linksys-wvc54gc/" />
<meta property="og:site_name" content="Gonzalo Ayuso" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2008-03-23T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Detectar movimiento con Linksys WVC54GC" />
<script type="application/ld+json">
{"headline":"Detectar movimiento con Linksys WVC54GC","dateModified":"2008-03-23T00:00:00+01:00","datePublished":"2008-03-23T00:00:00+01:00","url":"/2008/03/23/detectar-movimiento-con-linksys-wvc54gc/","mainEntityOfPage":{"@type":"WebPage","@id":"/2008/03/23/detectar-movimiento-con-linksys-wvc54gc/"},"author":{"@type":"Person","name":"Gonzalo Ayuso"},"description":"Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>


  <body>

    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>

<header class="panel-cover panel-cover--collapsed"
        style="background-image: url(/images/cover.jpg)">
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content">
                <a href="/" title="link to home of Gonzalo Ayuso">
                    <img src="/images/profile.jpg" class="user-image" alt="My Profile Photo">
                    <h1 class="panel-cover__title panel-title">Gonzalo Ayuso</h1>
                    <h3 class="panel-cover__title panel-title"><i>Web Architect</i></h3>
                </a>
                <div class="navigation-wrapper">
                    <h3 class="panel-cover__title panel-title"><i>Personal blog since 2008</i></h3>
                    <nav class="cover-navigation navigation--social">
                        <nav class="cover-navigation">
                            <ul class="navigation">
                                <li>
                                    <a href="/about" title="about">
                                        About Me
                                    </a>
                                </li>
                                <li class="navigation__item">
                                    <a href="/search" title="search">
                                         <i class="icon icon-page-search"></i>
                                        <span class="label">Search</span>
                                    </a>
                                </li>

                            </ul>
                        </nav>
                        <hr class="panel-cover__divider">
                        <ul class="navigation">
    
    <!-- Twitter -->
    <li class="navigation__item">
        <a href="http://twitter.com/gonzalo123"
           title="@gonzalo123 on Twitter" target="_blank">
            <i class="icon icon-social-twitter"></i>
            <span class="label">Twitter</span>
        </a>
    </li>
    

    
    <!-- LinkedIn -->
    <li class="navigation__item">
        <a href="https://www.linkedin.com/in/gonzaloayuso"
           title="gonzaloayuso on LinkedIn" target="_blank">
            <i class="icon icon-social-linkedin"></i>
            <span class="label">LinkedIn</span>
        </a>
    </li>
    

    
    <!-- GitHub -->
    <li class="navigation__item">
        <a href="https://www.github.com/gonzalo123"
           title="gonzalo123 on GitHub" target="_blank">
            <i class="icon icon-social-github"></i>
            <span class="label">GitHub</span>
        </a>
    </li>
    

    
    <!-- Email -->
    <li class="navigation__item">
        <a href="mailto:gonzalo123@gmail.com" title="Email gonzalo123@gmail.com"
           target="_blank">
            <i class="icon icon-mail"></i>
            <span class="label">Email</span>
        </a>
    </li>
    

    <!-- RSS -->
    <li class="navigation__item">
        <a href="/feed.xml" title="Subscribe" target="_blank">
            <i class="icon icon-rss"></i>
            <span class="label">RSS</span>
        </a>
    </li>

</ul>

                    </nav>
                    <div>
    <a href="https://leanpub.com/codigosolido"
       rel="noreferrer"
       data-ss1617366980="1">
        <img src="/assets/images/codigoSolido.png" alt="Código Sólido">
    </a>
    <p class="panel-cover__description">
        <i>
            Buy my book (Spanish) on Leanpub. (It's free but if you pay I'll donate all profits)
        </i>
    </p>
</div>

                </div>

            </div>

        </div>

        <div class="panel-cover--overlay"></div>
    </div>
</header>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
    <header class="post-header">
        <div class="post-meta">
            <time datetime=" 2008-03-23 00:00
            " class="post-meta__date date">23 Mar 2008</time>
            
            &#8226; <span class="post-meta__tags">on <a
                href="/tags/#linux">linux</a></span>
            
        </div>
        <h1 class="post-title">Detectar movimiento con Linksys WVC54GC</h1>
    </header>

    <section class="post">
        <p>Tengo una cámara Linksys WVC54GC y estoy jugando con la detección del movimiento. Para esto he encontrado un script en bash que tocado un poquito aqui y allá, que hace mas o menos lo que necesito.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
 
<span class="nv">FRAMERATE</span><span class="o">=</span>2
<span class="nv">SENSITIVITY</span><span class="o">=</span>30
<span class="nv">PNMPSNR</span><span class="o">=</span>/usr/bin/pnmpsnr
<span class="nb">cd</span> /mnt/data/.cam/
<span class="k">while </span><span class="nb">true
</span><span class="k">do
</span><span class="nb">sleep</span> <span class="nv">$FRAMERATE</span>
mplayer http://webcam/img/video.asf <span class="nt">-really-quiet</span> <span class="nt">-frames</span> 1 <span class="nt">-vo</span> jpeg
djpeg 00000001.jpg <span class="o">&gt;</span> current.ppm
<span class="nb">date</span><span class="o">&gt;</span>Ycolour
<span class="nv">$PNMPSNR</span> current.ppm last.ppm&gt;&gt;Ycolour 2&gt;
<span class="nv">Y</span><span class="o">=</span><span class="sb">`</span><span class="nb">awk</span> <span class="s1">'/Y  color/ {print int($5)}'</span> Ycolour<span class="sb">`</span>
<span class="k">if</span> <span class="o">[</span> <span class="nv">$Y</span> <span class="nt">-lt</span> <span class="nv">$SENSITIVITY</span> <span class="o">]</span>
<span class="k">then
 
if</span> <span class="o">[</span> <span class="nt">-d</span> ./<span class="sb">`</span><span class="nb">date</span> +%Y%m%d<span class="sb">`</span> <span class="o">]</span>
<span class="k">then
</span><span class="nb">cp </span>00000001.jpg ./<span class="sb">`</span><span class="nb">date</span> +%Y%m%d<span class="sb">`</span>/<span class="sb">`</span><span class="nb">date</span> +%y%m%d%H%M%S.jpg<span class="sb">`</span>
<span class="k">else
</span><span class="nb">mkdir</span>  ./<span class="sb">`</span><span class="nb">date</span> +%Y%m%d<span class="sb">`</span>
<span class="nb">cp </span>00000001.jpg ./<span class="sb">`</span><span class="nb">date</span> +%Y%m%d<span class="sb">`</span>/<span class="sb">`</span><span class="nb">date</span> +%y%m%d%H%M%S.jpg<span class="sb">`</span>
<span class="k">fi
 
fi
</span><span class="nb">mv </span>current.ppm last.ppm
</code></pre></div></div>

<p>Esto unido a un script en el init.d</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>donegonzalo@gnzl:/etc/init
gonzalo@gnzl:/etc/init.d<span class="nv">$ </span><span class="nb">cat </span>webcamd
<span class="c">#!/bin/sh</span>
<span class="c">### BEGIN INIT INFO</span>
<span class="c"># Provides:          webcamd</span>
<span class="c"># Required-Start:    networking</span>
<span class="c"># Required-Stop:     networking</span>
<span class="c"># Default-Start:     2 3 4 5</span>
<span class="c"># Default-Stop:      0 1 6</span>
<span class="c"># Short-Description: Start the webcamd web server.</span>
<span class="c">### END INIT INFO</span>
 
<span class="nv">PATH</span><span class="o">=</span>/sbin:/bin:/usr/sbin:/usr/bin
<span class="nv">NAME</span><span class="o">=</span>webcamd
<span class="nv">DESC</span><span class="o">=</span><span class="s2">"webcam snapshot motion"</span>
<span class="nv">PIDFILE</span><span class="o">=</span>/var/run/<span class="nv">$NAME</span>.pid
<span class="nv">SCRIPTNAME</span><span class="o">=</span>/etc/init.d/<span class="nv">$NAME</span>
<span class="nv">ENV</span><span class="o">=</span><span class="s2">"env -i LANG=C PATH=/usr/local/bin:/usr/bin:/bin"</span>
<span class="nv">SSD</span><span class="o">=</span><span class="s2">"/sbin/start-stop-daemon"</span>
 
<span class="nv">FRAMERATE</span><span class="o">=</span>2
<span class="nv">SENSITIVITY</span><span class="o">=</span>30
<span class="nv">PNMPSNR</span><span class="o">=</span>/usr/bin/pnmpsnr
<span class="nb">.</span> /lib/lsb/init-functions
<span class="nb">cd</span> /mnt/data/.cam/
<span class="k">case</span> <span class="s2">"</span><span class="nv">$1</span><span class="s2">"</span> <span class="k">in
</span>start<span class="p">)</span>
      <span class="nb">echo</span> <span class="s2">"Starting </span><span class="nv">$DESC</span><span class="s2">"</span> <span class="nv">$NAME</span>
      su <span class="nt">-l</span> gonzalo <span class="nt">-c</span> <span class="s2">"sh /mnt/data/.cam/startmotiondetection.sh &amp;"</span>
  <span class="p">;;</span>
<span class="k">*</span><span class="p">)</span>
 
      <span class="nb">exit </span>1
      <span class="p">;;</span>
<span class="k">esac</span>
 
<span class="nb">exit </span>0
</code></pre></div></div>

<p>Hace más o menos lo que quiero.</p>

<p>Si ya se que es muy mejorable ya que el tiempo que le he dedicado es muy poco (modo escusas activado). Si ya se que hay programas como Motion y Zoneminder que hacen esto mas bonito, pero bueno algún dia los miraré.</p>

<p>Mi principal problema es que la única forma que tengo para obtener una imagen fija de la camara es con el comando:</p>

<blockquote>
  <p>mplayer http://webcam/img/video.asf -really-quiet -frames 1 -vo jpeg</p>
</blockquote>

<p>ya que la cámara no me da la posibilidad de obterner la imagen directamente (o al menos no se como hacerlo). Mi problema es que esto no lo quiero ejecutar en un PC, como esta ahora, si no en un NSLU2, que es un aparatito con arquitectura ARM. Pues bien no consigo compilar el mplayer para ARM y encima creo que aunque lo consiga hacer no me va a funcionar ya que los codecs necesarios para ver un stream asf en Linux solo estan en formato binario para x86.</p>

<p>Me gustaría saber como se hace lo mismo que hago con mplayer con vlc (que si lo tengo correctamente instalado en el NSLU2). Otra opción es seguir las instrucciones que veo <a href="http://www.infohit.net/blog/post/motion-capture-using-the-wvc54gc-with-linux.html">aqui</a> para cer funcionar la camarita con Motion pero no consigo hacer el reetreaming con ffmpeg, ya que al hacer:</p>

<blockquote>
  <p>ffmpeg -an -i http://yourwebcam.up/img/video.asf http://localhost:8090/feed1.ffm</p>
</blockquote>

<p>me dice que no puede abrir el archivo asf y no tengo ni idea por que.</p>

<p>En fin seguire peleando,</p>



    </section>
    <p>
        <div class="page-share">
  <a href="https://twitter.com/intent/tweet?text=Detectar+movimiento+con+Linksys+WVC54GC%20%2F2008%2F03%2F23%2Fdetectar-movimiento-con-linksys-wvc54gc%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--twitter btn--small"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i> <span>Tweet</span></a>
  <a href="https://www.linkedin.com/shareArticle?mini=true&url=%2F2008%2F03%2F23%2Fdetectar-movimiento-con-linksys-wvc54gc%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--linkedin btn--small"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> <span>LinkedIn</span></a>
  <a href="https://reddit.com/submit?title=Detectar+movimiento+con+Linksys+WVC54GC&url=%2F2008%2F03%2F23%2Fdetectar-movimiento-con-linksys-wvc54gc%2F" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" class="btn btn--reddit btn--small"><i class="fab fa-fw fa-reddit" aria-hidden="true"></i> <span>Reddit</span></a>
</div>

    </p>
    
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
</article>

    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = '/2008/03/23/detectar-movimiento-con-linksys-wvc54gc/';  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = '/2008/03/23/detectar-movimiento-con-linksys-wvc54gc'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
      };

      (function() { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = '//gonzalo123-com.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
       })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




<div class="related">
    <h2>Related Posts</h2>
    <ul>
        
        <a href="/2021/03/08/playing-with-go-and-file-system-watchers/">
            <li>
                <h3>Playing with Go and file system watchers&nbsp;&nbsp;08 Mar 2021</h3>
            </li>
        </a>
        
        <a href="/2021/02/15/database-utils-for-psycopg2/">
            <li>
                <h3>Database utils for psycopg2&nbsp;&nbsp;15 Feb 2021</h3>
            </li>
        </a>
        
        <a href="/2021/01/11/playing-with-rabbitmq-python-and-docker-from-exchanges-to-queues/">
            <li>
                <h3>Playing with RabbitMQ, Python and Docker. From Exchanges to Queues&nbsp;&nbsp;11 Jan 2021</h3>
            </li>
        </a>
        
    </ul>
</div>

      </div>

      <footer class="footer">
  <span class="footer__copyright">&copy; 2021 Gonzalo Ayuso. All rights reserved.</span>
</footer>

<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js?1617453764168120000"></script>

    </div>
  </body>
</html>
